'use client'; import { useEffect, useState } from 'react'; export default function Pagamento({ params }:{params:{token:string}}){const [data,setData]=useState<any>(null); const [status,setStatus]=useState('loading'); useEffect(()=>{fetch(`/api/payment-intent/${params.token}`).then(r=>r.json()).then(d=>{setData(d);setStatus(d.status);}); const t=setInterval(async()=>{const r=await fetch(`/api/payment-intent/${params.token}`); const d=await r.json(); setStatus(d.status);},5000); return ()=>clearInterval(t);},[params.token]); if(!data) return <main className="p-6">Carregando...</main>; if(status==='paid') return <main className="p-6">Pagamento confirmado âœ…</main>; const exp=data.expires_at?new Date(data.expires_at):null; return(<main className="max-w-md mx-auto p-6 space-y-3"><h1 className="text-xl font-semibold">Pagar consulta</h1>{data.qr_code_base64 && (<img src={`data:image/png;base64,${data.qr_code_base64}`} alt="QR PIX" className="border rounded" />)}<div className="text-sm break-all bg-gray-100 p-2 rounded">{data.qr_code_payload||'---'}</div>{exp && <div className="text-xs text-gray-600">Expira: {exp.toLocaleString()}</div>}<button onClick={()=>location.reload()} className="w-full bg-gray-200 py-2 rounded">Atualizar</button></main>);}